p.mat<- matrix(NA, n, n)
diag(p.mat) <- 0
for (i in 1:(n - 1)) {
for (j in (i + 1):n) {
tmp <- cor.test(mat[, i], mat[, j])
p.mat[i, j] <- p.mat[j, i] <- tmp$p.value
}
}
colnames(p.mat) <- rownames(p.mat) <- colnames(mat)
p.mat
}
var_corr=c("Yield",'Nb_Pan','Nb_Kern','TKW','HI','SF','DaysFL','phylochron','Width','Length','Nb_Til','Nb_Lea','SGA','PH','VDW','Asat','Aqe','Lcp','ETRm','alpha','Ik')
donCorr=na.omit(don%>%
select(c('Id','Plant','Treatment','Variety',var_corr)))
donCor_C=donCorr%>%filter(Treatment=='C')%>%select(-c(Treatment,Variety,Plant,Id))
donCor_S=donCorr%>%filter(Treatment=='S')%>%select(-c(Treatment,Variety,Plant,Id))
donCor_SAF=donCorr%>%filter(Treatment=='S-AF')%>%select(-c(Treatment,Variety,Plant,Id))
don_cor_all=donCorr%>%select(-c(Treatment,Variety,Plant,Id))
corC=ggcorrplot(cor(donCor_C)
, hc.order = F, type = 'lower', tl.srt = 45,
lab = T,p.mat =computepvalue(cor(donCor_C)), sig.level = 0.01,insig = "blank")+
ggtitle('C')
corS=ggcorrplot(cor(donCor_S)
, hc.order = F, type = 'lower', tl.srt = 45,
lab = T,p.mat =computepvalue(cor(donCor_C)), sig.level = 0.01,insig = "blank")+
ggtitle('S')
corSAF=ggcorrplot(cor(donCor_SAF)
, hc.order = F, type = 'lower', tl.srt = 45,
lab = T,p.mat =computepvalue(cor(donCor_C)), sig.level = 0.01,insig = "blank")+
ggtitle('S-AF')
corAll=ggcorrplot(cor(don_cor_all)
, hc.order = F, type = 'lower', tl.srt = 45,
lab = T,p.mat =computepvalue(cor(donCor_C)), sig.level = 0.01,insig = "blank")+
ggtitle('All treatments')
cowplot::plot_grid(hjust = -0.2,corC,corS,corSAF,corAll,
ncol=2,
labels=c('A','B','C','D'))
ggsave(filename = '2-outputs/Figures_rev/FigCorrelations.png',width = 18,height =18)
# PCA ---------------------------------------------------------------------
set.seed(1)
var_ACP=c("Yield",'Nb_Kern','TKW','HI','SF','DaysFL','phylochron','Width','Length','Nb_Til','Nb_Lea','SGA','VDW','Asat','Lcp','Ik')
donACP=na.omit(don%>%
select(c('Id','Plant','Treatment','Variety',var_ACP)))
acpAll=f.ACP(don=donACP,vars = var_ACP,table_type = tableNames)
acpAll$gr_vp
tableACP=round(acpAll$table[,c(1,2,3)],2)
data.table::fwrite(tableACP,file = '2-outputs/Tables_rev/Table_PCA.csv',row.names =T )
cowplot::plot_grid(hjust = -0.2,
acpAll$gr_corr12+myTheme+theme(legend.position = 'none'),
acpAll$gr_proj12+myTheme+theme(legend.position=c(0.8,0.9),legend.title=element_blank()),
labels=c('A','B'),
ncol=2)
ggsave(filename = '2-outputs/Figures_rev/FigACP.png',width = 10,height =5)
### LRT
donModAll=merge(acpAll$data%>%
rename(PC1=x,PC2=y,PC3=z)%>%
select(Variety,Plant,Id,Treatment,PC1,PC2,PC3),lightCarac%>%select(Treatment,DLI,DLF),all.x =T,all.y=F)%>%
filter(!Plant %in% c('D_V3_3','L_V3_3'))
tableModACP=NULL
for (var in c('PC1','PC2','PC3')){
# var='PC1'
sub=donModAll%>%filter(!is.na(get(var)))
mod=lm(data=sub,formula = get(var)~Variety+as.numeric(DLI)+Variety:as.numeric(DLI)+as.numeric(DLF)+Variety:as.numeric(DLF))
mod2=lm(data=sub,formula = get(var)~Variety+as.numeric(DLI)+Variety:as.numeric(DLI))
tableModACP_sub=data.frame(var= var,
Variety=f.sig(p=anova(mod)["Pr(>F)"]['Variety',1]),
DLI=f.sig(p=anova(mod)["Pr(>F)"]['as.numeric(DLI)',1]),
DLF=f.sig(p=anova(mod)["Pr(>F)"]['as.numeric(DLF)',1]),
`Variety x DLI`=f.sig(p=anova(mod)["Pr(>F)"]['Variety:as.numeric(DLI)',1]),
`Variety x DLF`=f.sig(p=anova(mod)["Pr(>F)"]['Variety:as.numeric(DLF)',1]),
r2=  round(summary(mod)$adj.r.squared,2),
`LRtest`=f.sig(p=lrtest(mod, mod2)["Pr(>Chisq)"][2,]))
tableModACP=rbind(tableModACP,tableModACP_sub)
}
print(tableModACP)
set.seed(1)
var_ACP=c("Yield",'Nb_Kern','TKW','HI','SF','DaysFL','phylochron','Width','Length','Nb_Til','Nb_Lea','SGA','VDW','Asat','Aqe','Lcp','Ik')
donACP=na.omit(don%>%
select(c('Id','Plant','Treatment','Variety',var_ACP)))
acpAll=f.ACP(don=donACP,vars = var_ACP,table_type = tableNames)
acpAll$gr_vp
tableACP=round(acpAll$table[,c(1,2,3)],2)
data.table::fwrite(tableACP,file = '2-outputs/Tables_rev/Table_PCA.csv',row.names =T )
cowplot::plot_grid(hjust = -0.2,
acpAll$gr_corr12+myTheme+theme(legend.position = 'none'),
acpAll$gr_proj12+myTheme+theme(legend.position=c(0.8,0.9),legend.title=element_blank()),
labels=c('A','B'),
ncol=2)
donModAll=merge(acpAll$data%>%
rename(PC1=x,PC2=y,PC3=z)%>%
select(Variety,Plant,Id,Treatment,PC1,PC2,PC3),lightCarac%>%select(Treatment,DLI,DLF),all.x =T,all.y=F)%>%
filter(!Plant %in% c('D_V3_3','L_V3_3'))
tableModACP=NULL
for (var in c('PC1','PC2','PC3')){
# var='PC1'
sub=donModAll%>%filter(!is.na(get(var)))
mod=lm(data=sub,formula = get(var)~Variety+as.numeric(DLI)+Variety:as.numeric(DLI)+as.numeric(DLF)+Variety:as.numeric(DLF))
mod2=lm(data=sub,formula = get(var)~Variety+as.numeric(DLI)+Variety:as.numeric(DLI))
tableModACP_sub=data.frame(var= var,
Variety=f.sig(p=anova(mod)["Pr(>F)"]['Variety',1]),
DLI=f.sig(p=anova(mod)["Pr(>F)"]['as.numeric(DLI)',1]),
DLF=f.sig(p=anova(mod)["Pr(>F)"]['as.numeric(DLF)',1]),
`Variety x DLI`=f.sig(p=anova(mod)["Pr(>F)"]['Variety:as.numeric(DLI)',1]),
`Variety x DLF`=f.sig(p=anova(mod)["Pr(>F)"]['Variety:as.numeric(DLF)',1]),
r2=  round(summary(mod)$adj.r.squared,2),
`LRtest`=f.sig(p=lrtest(mod, mod2)["Pr(>Chisq)"][2,]))
tableModACP=rbind(tableModACP,tableModACP_sub)
}
print(tableModACP)
tableACP=round(acpAll$table[,c(1,2,3)],2)
tableACP
set.seed(1)
var_ACP=c("Yield",'Nb_Kern','TKW','HI','SF','DaysFL','phylochron','Width','Length','Nb_Til','Nb_Lea','SGA','VDW','Asat','Lcp','Ik')
donACP=na.omit(don%>%
select(c('Id','Plant','Treatment','Variety',var_ACP)))
acpAll=f.ACP(don=donACP,vars = var_ACP,table_type = tableNames)
acpAll$gr_vp
tableACP=round(acpAll$table[,c(1,2,3)],2)
data.table::fwrite(tableACP,file = '2-outputs/Tables_rev/Table_PCA.csv',row.names =T )
cowplot::plot_grid(hjust = -0.2,
acpAll$gr_corr12+myTheme+theme(legend.position = 'none'),
acpAll$gr_proj12+myTheme+theme(legend.position=c(0.8,0.9),legend.title=element_blank()),
labels=c('A','B'),
ncol=2)
ggsave(filename = '2-outputs/Figures_rev/FigACP.png',width = 10,height =5)
donModAll=merge(acpAll$data%>%
rename(PC1=x,PC2=y,PC3=z)%>%
select(Variety,Plant,Id,Treatment,PC1,PC2,PC3),lightCarac%>%select(Treatment,DLI,DLF),all.x =T,all.y=F)%>%
filter(!Plant %in% c('D_V3_3','L_V3_3'))
tableModACP=NULL
for (var in c('PC1','PC2','PC3')){
# var='PC1'
sub=donModAll%>%filter(!is.na(get(var)))
mod=lm(data=sub,formula = get(var)~Variety+as.numeric(DLI)+Variety:as.numeric(DLI)+as.numeric(DLF)+Variety:as.numeric(DLF))
mod2=lm(data=sub,formula = get(var)~Variety+as.numeric(DLI)+Variety:as.numeric(DLI))
tableModACP_sub=data.frame(var= var,
Variety=f.sig(p=anova(mod)["Pr(>F)"]['Variety',1]),
DLI=f.sig(p=anova(mod)["Pr(>F)"]['as.numeric(DLI)',1]),
DLF=f.sig(p=anova(mod)["Pr(>F)"]['as.numeric(DLF)',1]),
`Variety x DLI`=f.sig(p=anova(mod)["Pr(>F)"]['Variety:as.numeric(DLI)',1]),
`Variety x DLF`=f.sig(p=anova(mod)["Pr(>F)"]['Variety:as.numeric(DLF)',1]),
r2=  round(summary(mod)$adj.r.squared,2),
`LRtest`=f.sig(p=lrtest(mod, mod2)["Pr(>Chisq)"][2,]))
tableModACP=rbind(tableModACP,tableModACP_sub)
}
print(tableModACP)
acpAll$gr_vp
data.table::fwrite(tableModACP,file = '2-outputs/Tables_rev/Table_PCAtests.csv',row.names =T )
set.seed(1)
var_ACP=c('Nb_Kern','TKW','HI','SF','DaysFL','phylochron','Width','Length','Nb_Til','Nb_Lea','SGA','VDW','Asat','Lcp','Ik')
donACP=na.omit(don%>%
select(c('Id','Plant','Treatment','Variety',var_ACP)))
acpAll=f.ACP(don=donACP,vars = var_ACP,table_type = tableNames)
acpAll$gr_vp
tableACP=round(acpAll$table[,c(1,2,3)],2)
data.table::fwrite(tableACP,file = '2-outputs/Tables_rev/Table_PCA.csv',row.names =T )
cowplot::plot_grid(hjust = -0.2,
acpAll$gr_corr12+myTheme+theme(legend.position = 'none'),
acpAll$gr_proj12+myTheme+theme(legend.position=c(0.8,0.9),legend.title=element_blank()),
labels=c('A','B'),
ncol=2)
set.seed(1)
var_ACP=c('Nb_Kern','TKW','HI','SF','DaysFL','phylochron','Width','Length','Nb_Til','Nb_Lea','SGA','VDW','Asat','Lcp','Ik')
donACP=na.omit(don%>%
select(c('Id','Plant','Treatment','Variety',var_ACP)))
acpAll=f.ACP(don=donACP,vars = var_ACP,table_type = tableNames)
acpAll$gr_vp
tableACP=round(acpAll$table[,c(1,2,3)],2)
data.table::fwrite(tableACP,file = '2-outputs/Tables_rev/Table_PCA.csv',row.names =T )
cowplot::plot_grid(hjust = -0.2,
acpAll$gr_corr12+myTheme+theme(legend.position = 'none'),
acpAll$gr_proj12+myTheme+theme(legend.position=c(0.8,0.9),legend.title=element_blank()),
labels=c('A','B'),
ncol=2)
min(5:1, pi)
pmin(5:1, pi)
pmin(1,2,3,4,5,)
pmin(1,2,3,4,5)
### yield
### tuckey for each treatment
dbox=don%>%
mutate(group=paste(Treatment,Variety))
unique(dbox$Treatment)
unique(dbox$group)
### yield
### tuckey for each treatment
dbox=don%>%
mutate(group=paste(Treatment,Variety))
donT_all=NULL
t=unique(dbox$group)[1]
modelTuckeyT<-aov(Yield~group, data=dbox%>%
filter(Treatment==t))
modelTuckeyT<-aov(Yield~group, data=dbox)
modelTuckeyT<-aov(Yield~group, data=dbox)
outV <- HSD.test(modelTuckeyT,"group", group=TRUE,console=F,
main="")
resV=data.frame(outV$means)
resGV=data.frame(outV$groups)
colnames(resV)[1]='Yield'
colnames(resGV)[1]='Yield'
donT=merge(resV%>%
mutate(group=t,
Variety=row.names(data.frame(outV$means))),resGV)
donT_all=rbind(donT_all,donT)
donT_all=NULL
for (t in unique(dbox$group)){
modelTuckeyT<-aov(Yield~group, data=dbox)
outV <- HSD.test(modelTuckeyT,"group", group=TRUE,console=F,
main="")
resV=data.frame(outV$means)
resGV=data.frame(outV$groups)
colnames(resV)[1]='Yield'
colnames(resGV)[1]='Yield'
donT=merge(resV%>%
mutate(group=t,
Variety=row.names(data.frame(outV$means))),resGV)
donT_all=rbind(donT_all,donT)
}
ggplot()+
geom_boxplot(data=dbox,aes(x=Variety,y=Yield,group=paste(Variety,Treatment),col=Variety),notch=F,outlier.colour=NA)+
geom_jitter(data=dbox,aes(x=Variety,y=Yield,group=paste(Variety,Treatment),col=Variety),height=0)+
geom_text(data=donT_all,aes(x=dbox,y=1.1*Yield+1.8*std,label=groups,col=Variety))
ggplot()+
geom_boxplot(data=dbox,aes(x=Variety,y=Yield,group=paste(Variety,Treatment),col=Variety),notch=F,outlier.colour=NA)+
geom_jitter(data=dbox,aes(x=Variety,y=Yield,group=paste(Variety,Treatment),col=Variety),height=0)
donT
resV
resV=data.frame(outV$means)
resGV=data.frame(outV$groups)
resGV
colnames(resV)[1]='Yield'
colnames(resGV)[1]='Yield'
resV
resGV
donT=merge(resV%>%
mutate(group=row.names(data.frame(outV$means))),resGV)
donT
donVT=merge(resV%>%
mutate(group=row.names(data.frame(outV$means))),resGV)%>%
separate(col = group,into = c('Treatment','Variety'),sep =' ')
donVT
ggplot()+
geom_boxplot(data=donVT,aes(x=Variety,y=Yield,group=paste(Variety,Treatment),col=Variety),notch=F,outlier.colour=NA)+
geom_jitter(data=donVT,aes(x=Variety,y=Yield,group=paste(Variety,Treatment),col=Variety),height=0)+
geom_text(data=donVT,aes(x=dbox,y=1.1*Yield+1.8*std,label=groups,col=Variety))+
# facet_grid(~Treatment)+
scale_color_manual(name='Variety',values = color_Var)+
ylab(expression('Yield'*' '*(g.plant**-1)))+
xlab('')+
myTheme+
theme(legend.position='none')
ggplot()+
geom_boxplot(data=donVT,aes(x=Variety,y=Yield,group=paste(Variety,Treatment),col=Variety),notch=F,outlier.colour=NA)
ggplot()+
geom_boxplot(data=donVT,aes(x=Variety,y=Yield,group=paste(Variety,Treatment),col=Variety),notch=F,outlier.colour=NA)+
geom_jitter(data=donVT,aes(x=Variety,y=Yield,group=paste(Variety,Treatment),col=Variety),height=0)
ggplot()+
geom_boxplot(data=dbox,aes(x=Variety,y=Yield,group=paste(Variety,Treatment),col=Variety),notch=F,outlier.colour=NA)+
geom_jitter(data=dbox,aes(x=Variety,y=Yield,group=paste(Variety,Treatment),col=Variety),height=0)+
geom_text(data=donVT,aes(x=Variety,y=1.1*Yield+1.8*std,label=groups,col=Variety))+
# facet_grid(~Treatment)+
scale_color_manual(name='Variety',values = color_Var)+
ylab(expression('Yield'*' '*(g.plant**-1)))+
xlab('')+
myTheme+
theme(legend.position='none')
ggplot()+
geom_boxplot(data=dbox,aes(x=Variety,y=Yield,group=paste(Variety,Treatment),col=Treatment),notch=F,outlier.colour=NA)+
geom_jitter(data=dbox,aes(x=Variety,y=Yield,group=paste(Variety,Treatment),col=Treatment),height=0)+
geom_text(data=donVT,aes(x=Variety,y=1.1*Yield+1.8*std,label=groups,col=Variety))+
# facet_grid(~Treatment)+
scale_color_manual(name='Variety',values = color_Var)+
ylab(expression('Yield'*' '*(g.plant**-1)))+
xlab('')+
myTheme+
theme(legend.position='none')
ggplot()+
geom_boxplot(data=dbox,aes(x=Variety,y=Yield,group=paste(Variety,Treatment),col=Treatment),notch=F,outlier.colour=NA)+
geom_jitter(data=dbox,aes(x=Variety,y=Yield,group=paste(Variety,Treatment),col=Treatment),height=0)+
geom_text(data=donVT,aes(x=Variety,y=1.1*Yield+1.8*std,label=groups,col=Variety))+
# facet_grid(~Treatment)+
# scale_color_manual(name='Variety',values = color_Var)+
ylab(expression('Yield'*' '*(g.plant**-1)))+
xlab('')+
myTheme+
theme(legend.position='none')
donVT
ggplot()+
geom_boxplot(data=dbox,aes(x=Variety,y=Yield,group=paste(Variety,Treatment),col=Treatment),notch=F,outlier.colour=NA)+
geom_jitter(data=dbox,aes(x=Variety,y=Yield,group=paste(Variety,Treatment),col=Treatment),height=0)+
geom_text(data=donVT,aes(x=paste(Variety,Treatment),y=1.1*Yield+1.8*std,label=paste(Variety,Treatment),col=Variety))+
# facet_grid(~Treatment)+
# scale_color_manual(name='Variety',values = color_Var)+
ylab(expression('Yield'*' '*(g.plant**-1)))+
xlab('')+
myTheme+
theme(legend.position='none')
donVT
ggplot()+
geom_boxplot(data=dbox,aes(x=Variety,y=Yield,group=paste(Variety,Treatment),col=Treatment),notch=F,outlier.colour=NA)+
geom_jitter(data=dbox,aes(x=Variety,y=Yield,group=paste(Variety,Treatment),col=Treatment),height=0)
ggplot()+
geom_boxplot(data=dbox,aes(x=Variety,y=Yield,group=paste(Variety,Treatment),col=Treatment),notch=F,outlier.colour=NA)+
geom_jitter(data=dbox,aes(x=Variety,y=Yield,group=paste(Variety,Treatment),col=Treatment),height=0,width = 0)+
geom_text(data=donVT,aes(x=Variety,y=1.1*Yield+1.8*std,label=groups,col=Variety))+
# facet_grid(~Treatment)+
# scale_color_manual(name='Variety',values = color_Var)+
ylab(expression('Yield'*' '*(g.plant**-1)))+
xlab('')+
myTheme+
theme(legend.position='none')
donV_all=NULL
for (t in unique(don$Variety)){
modelTuckeyT<-aov(Yield~Treatment, data=don%>%
filter(Variety==t))
outV <- HSD.test(modelTuckeyT,"Treatment", group=TRUE,console=F,
main="")
resV=data.frame(outV$means)
resGV=data.frame(outV$groups)
colnames(resV)[1]='Yield'
colnames(resGV)[1]='Yield'
donV=merge(resV%>%
mutate(Variety=t,
Treatment=row.names(data.frame(outV$means))),resGV)
donV_all=rbind(donV_all,donV)
}
plotYield=ggplot()+
geom_boxplot(data=don,aes(x=Treatment,y=Yield,group=paste(Variety,Treatment),col=Treatment),notch=F,outlier.colour=NA)+
geom_jitter(data=don,aes(x=Treatment,y=Yield,group=paste(Variety,Treatment),col=Treatment),height=0)+
geom_text(data=donT_all,aes(x=Treatment,y=1.1*Yield+1.8*std,label=groups,col=Treatment))+
facet_grid(~Variety)+
# scale_color_manual(name='Treatment',values = color_Var)+
ylab(expression('Yield'*' '*(g.plant**-1)))+
xlab('')+
myTheme+
theme(legend.position='none')
plotYield
plotYield=ggplot()+
geom_boxplot(data=don,aes(x=Treatment,y=Yield,group=paste(Variety,Treatment),col=Treatment),notch=F,outlier.colour=NA)+
geom_jitter(data=don,aes(x=Treatment,y=Yield,group=paste(Variety,Treatment),col=Treatment),height=0)+
geom_text(data=donV_all,aes(x=Treatment,y=1.1*Yield+1.8*std,label=groups,col=Treatment))+
facet_grid(~Variety)+
# scale_color_manual(name='Treatment',values = color_Var)+
ylab(expression('Yield'*' '*(g.plant**-1)))+
xlab('')+
myTheme+
theme(legend.position='none')
plotYield
plotYield=ggplot()+
geom_boxplot(data=don,aes(x=Treatment,y=Yield,group=paste(Variety,Treatment),col=Treatment),notch=F,outlier.colour=NA)+
geom_jitter(data=don,aes(x=Treatment,y=Yield,group=paste(Variety,Treatment),col=Treatment),height=0)+
geom_text(data=donV_all,aes(x=Treatment,y=1.1*Yield+1.8*std,label=groups,col=Treatment))+
facet_grid(~Variety)+
scale_color_manual(name='Treatment',values = color_Trt)+
ylab(expression('Yield'*' '*(g.plant**-1)))+
xlab('')+
myTheme+
theme(legend.position='none')
plotYield
donTKW=NULL
for (t in unique(don$Variety)){
modelTuckeyT<-aov(TKW~Treatment, data=don%>%
filter(Variety==t))
outV <- HSD.test(modelTuckeyT,"Treatment", group=TRUE,console=F,
main="")
resV=data.frame(outV$means)
resGV=data.frame(outV$groups)
colnames(resV)[1]='TKW'
colnames(resGV)[1]='TKW'
donT=merge(resV%>%
mutate(Variety=t,
Treatment=row.names(data.frame(outV$means))),resGV)
donTKW=rbind(donTKW,donT)
}
plotTKW=ggplot()+
geom_boxplot(data=don,aes(x=Treatment,y=TKW,group=paste(Variety,Treatment),col=Treatment),notch=F,outlier.colour=NA)+
geom_jitter(data=don,aes(x=Treatment,y=TKW,group=paste(Variety,Treatment),col=Treatment),height=0)+
geom_text(data=donTKW,aes(x=Treatment,y=1.1*TKW+1.8*std,label=groups,col=Treatment))+
facet_grid(~Treatment)+
scale_color_manual(name='Treatment',values = color_Trt)+
ylab(expression('Thousand kernel weight'*' '*(g)))+
xlab('')+
myTheme+
theme(legend.position='none')
plotTKW
plotTKW=ggplot()+
geom_boxplot(data=don,aes(x=Treatment,y=TKW,group=paste(Variety,Treatment),col=Treatment),notch=F,outlier.colour=NA)+
geom_jitter(data=don,aes(x=Treatment,y=TKW,group=paste(Variety,Treatment),col=Treatment),height=0)+
geom_text(data=donTKW,aes(x=Treatment,y=1.1*TKW+1.8*std,label=groups,col=Treatment))+
facet_grid(~Variety)+
scale_color_manual(name='Treatment',values = color_Trt)+
ylab(expression('Thousand kernel weight'*' '*(g)))+
xlab('')+
myTheme+
theme(legend.position='none')
plotTKW
### tuckey for each variety
donVDW=NULL
for (t in unique(don$Variety)){
modelTuckeyT<-aov(VDW~Treatment, data=don%>%
filter(Variety==t))
outV <- HSD.test(modelTuckeyT,"Treatment", group=TRUE,console=F,
main="")
resV=data.frame(outV$means)
resGV=data.frame(outV$groups)
colnames(resV)[1]='VDW'
colnames(resGV)[1]='VDW'
donT=merge(resV%>%
mutate(Variety=t,
Treatment=row.names(data.frame(outV$means))),resGV)
donVDW=rbind(donVDW,donT)
}
plotVDW=ggplot()+
geom_boxplot(data=don,aes(x=Treatment,y=VDW,group=paste(Variety,Treatment),col=Treatment),notch=F,outlier.colour=NA)+
geom_jitter(data=don,aes(x=Treatment,y=VDW,group=paste(Variety,Treatment),col=Treatment),height=0)+
geom_text(data=donVDW,aes(x=Treatment,y=1.1*VDW+1.8*std,label=groups,col=Treatment))+
facet_grid(~Variety)+
scale_color_manual(name='Treatment',values = color_Trt)+
ylab(expression('Vegetative dry weight'*' '*(g*'plant'**-1)))+
xlab('')+
myTheme+
theme(legend.position='none')
plotVDW
### tuckey for each treatment
donSGA=NULL
for (t in unique(don$Variety)){
modelTuckeyT<-aov(SGA~Treatment, data=don%>%
filter(Variety==t))
outV <- HSD.test(modelTuckeyT,"Treatment", group=TRUE,console=F,
main="")
resV=data.frame(outV$means)
resGV=data.frame(outV$groups)
colnames(resV)[1]='SGA'
colnames(resGV)[1]='SGA'
donT=merge(resV%>%
mutate(Variety=t,
Treatment=row.names(data.frame(outV$means))),resGV)
donSGA=rbind(donSGA,donT)
}
plotSGA=ggplot()+
geom_boxplot(data=don,aes(x=Treatment,y=SGA,group=paste(Variety,Treatment),col=Treatment),notch=F,outlier.colour=NA)+
geom_jitter(data=don,aes(x=Treatment,y=VDW,group=paste(Variety,Treatment),col=Treatment),height=0)+
geom_text(data=donVDW,aes(x=Treatment,y=1.1*VDW+1.8*std,label=groups,col=Treatment))+
facet_grid(~Variety)+
scale_color_manual(name='Treatment',values = color_Trt)+
ylab(expression('Stay grean area'*' '*(cm**2*'plant'**-1)))+
xlab('')+
myTheme+
theme(legend.position='none')
plotSGA
### tuckey for each treatment
donSGA=NULL
for (t in unique(don$Variety)){
modelTuckeyT<-aov(SGA~Treatment, data=don%>%
filter(Variety==t))
outV <- HSD.test(modelTuckeyT,"Treatment", group=TRUE,console=F,
main="")
resV=data.frame(outV$means)
resGV=data.frame(outV$groups)
colnames(resV)[1]='SGA'
colnames(resGV)[1]='SGA'
donT=merge(resV%>%
mutate(Variety=t,
Treatment=row.names(data.frame(outV$means))),resGV)
donSGA=rbind(donSGA,donT)
}
plotSGA=ggplot()+
geom_boxplot(data=don,aes(x=Treatment,y=SGA,group=paste(Variety,Treatment),col=Treatment),notch=F,outlier.colour=NA)+
geom_jitter(data=don,aes(x=Treatment,y=SGA,group=paste(Variety,Treatment),col=Treatment),height=0)+
geom_text(data=donVDW,aes(x=Treatment,y=1.1*SGA+1.8*std,label=groups,col=Treatment))+
facet_grid(~Variety)+
scale_color_manual(name='Treatment',values = color_Trt)+
ylab(expression('Stay grean area'*' '*(cm**2*'plant'**-1)))+
xlab('')+
myTheme+
theme(legend.position='none')
plotSGA=ggplot()+
geom_boxplot(data=don,aes(x=Treatment,y=SGA,group=paste(Variety,Treatment),col=Treatment),notch=F,outlier.colour=NA)+
geom_jitter(data=don,aes(x=Treatment,y=SGA,group=paste(Variety,Treatment),col=Treatment),height=0)+
geom_text(data=donVDW,aes(x=Treatment,y=1.1*SGA+1.8*std,label=groups,col=Treatment))+
facet_grid(~Variety)+
scale_color_manual(name='Treatment',values = color_Trt)+
ylab(expression('Stay grean area'*' '*(cm**2*'plant'**-1)))+
xlab('')+
myTheme+
theme(legend.position='none')
plotSGA
plotSGA=ggplot()+
geom_boxplot(data=don,aes(x=Treatment,y=SGA,group=paste(Variety,Treatment),col=Treatment),notch=F,outlier.colour=NA)+
geom_jitter(data=don,aes(x=Treatment,y=SGA,group=paste(Variety,Treatment),col=Treatment),height=0)+
geom_text(data=donSGA,aes(x=Treatment,y=1.1*SGA+1.8*std,label=groups,col=Treatment))+
facet_grid(~Variety)+
scale_color_manual(name='Treatment',values = color_Trt)+
ylab(expression('Stay grean area'*' '*(cm**2*'plant'**-1)))+
xlab('')+
myTheme+
theme(legend.position='none')
plotSGA
cowplot::plot_grid(plotVDW,plotSGA,plotYield,plotTKW,ncol=2,labels=c('A','B','C','D'))
cowplot::plot_grid(plotSGA,plotYield,plotTKW,ncol=2,labels=c('A','B','C','D'))
cowplot::plot_grid(plotSGA,plotYield,plotTKW,ncol=3,labels=c('A','B','C'))
cowplot::plot_grid(plotSGA,plotYield,plotTKW,ncol=1,labels=c('A','B','C'))
cowplot::plot_grid(plotSGA,plotYield,ncol=2,labels=c('A','B'))
ggsave(filename = '2-outputs/Figures_rev/Boxplots.png',width = 10,height = 8)
ggsave(filename = '2-outputs/Figures_rev/Boxplots.png',width = 8,height = 8)
ggsave(filename = '2-outputs/Figures_rev/Boxplots.png',width = 8,height = 6)
ggsave(filename = '2-outputs/Figures_rev/Boxplots.png',width = 8,height = 4)
ggsave(filename = '2-outputs/Figures_rev/Boxplots.png',width = 10,height = 5)
cowplot::plot_grid(plotSGA,plotYield,ncol=1,labels=c('A','B'))
ggsave(filename = '2-outputs/Figures_rev/Boxplots.png',width = 10,height = 5)
ggsave(filename = '2-outputs/Figures_rev/Boxplots.png',width = 10,height = 8)
ggsave(filename = '2-outputs/Figures_rev/Boxplots.png',width = 8,height = 6)
